--MAGNITUDE ANALYSIS

--FIND TOTAL CUSTOMER BY COUNTRIES

   SELECT COUNT(CUSTOMER_KEY) TOTAL_CUSTOMERS, COUNTRY
   FROM `first-447405.DataWarehouseAnalytics.Gold_dim_customers`
   GROUP BY 2
   ORDER BY 1 DESC

 --FIND TOTAL CUSTOMERS BY GENDER

  SELECT COUNT(CUSTOMER_KEY) TOTAL_CUSTOMERS, GENDER
   FROM `first-447405.DataWarehouseAnalytics.Gold_dim_customers`
   GROUP BY 2
   ORDER BY 1 DESC

--FIND TOTAL PRODUCTS BY CATEGORY

  SELECT COUNT(PRODUCT_KEY) TOTAL_CUSTOMERS,CATEGORY
   FROM `first-447405.DataWarehouseAnalytics.GOld_dim_products`
   GROUP BY 2
   ORDER BY 1 DESC

 --WHAT IS THE AVERAGE COSTS IN EACH CATEGORY?

  SELECT AVG(COST) AS AVERAGE_COST, category
   FROM `first-447405.DataWarehouseAnalytics.GOld_dim_products`
   GROUP BY 2
   ORDER BY 1 DESC

 --WHAT IS THE TOTAL REVENUE GENERATED FOR EACH CATEGORY?

   SELECT SUM(S.SALES_AMOUNT),P.CATEGORY
  FROM `first-447405.DataWarehouseAnalytics.Gold_fact_sales` AS S
  LEFT JOIN `first-447405.DataWarehouseAnalytics.GOld_dim_products` P
  ON P.PRODUCT_KEY=S.PRODUCT_KEY
  GROUP BY 2
  ORDER BY 1 DESC

 --FIND TOTAL REVENUE IS GENERATED BY EACH CUSTOMER

  SELECT C.customer_key,C.first_name,C.last_name,SUM(S.SALES_AMOUNT)AS TOTAL_REVENUE
  FROM `first-447405.DataWarehouseAnalytics.Gold_dim_customers` C
  LEFT JOIN `first-447405.DataWarehouseAnalytics.Gold_fact_sales` AS S
  ON C.CUSTOMER_KEY=S.CUSTOMER_KEY
  GROUP BY 1,2,3
  ORDER BY 4 DESC
 
 --WHAT IS THE DISTRIBUTION OF SOLD ITEMS ACROSS COUNTRIES?

   SELECT C.COUNTRY,SUM(S.QUANTITY)AS TOTAL_QUANTITY
  FROM `first-447405.DataWarehouseAnalytics.Gold_dim_customers` C
  LEFT JOIN `first-447405.DataWarehouseAnalytics.Gold_fact_sales` AS S
  ON C.CUSTOMER_KEY=S.CUSTOMER_KEY
  GROUP BY 1
  ORDER BY 2 DESC
